local Library = loadstring(game:HttpGetAsync("https://github.com/ActualMasterOogway/Fluent-Renewed/releases/latest/download/Fluent.luau"))()
local SaveManager = loadstring(game:HttpGetAsync("https://raw.githubusercontent.com/ActualMasterOogway/Fluent-Renewed/master/Addons/SaveManager.luau"))()
local InterfaceManager = loadstring(game:HttpGetAsync("https://raw.githubusercontent.com/ActualMasterOogway/Fluent-Renewed/master/Addons/InterfaceManager.luau"))()

local Window = Library:Window{
    Title = "Pull A Sword Events",
    SubTitle = "By coco",
    TabWidth = 130,
    Size =  UDim2.fromOffset(500, 430),
    Resize = false, 
    Theme = "Darker",
    MinimizeKey = Enum.KeyCode.LeftShift
}

-- Tabs
local Tabs = {
    Stuff1 = Window:CreateTab{Title = "Main Game", Icon = "phosphor-sword-bold"},
    Settings = Window:CreateTab{Title = "Settings", Icon = "phosphor-sword-bold"}
}

local Options = Library.Options

Tabs.Stuff1:CreateToggle("AutoWin", {Title = "Auto Winn", Default = false})
    :OnChanged(function(state)
        if state then
            task.spawn(function()
                local Players = game:GetService("Players")
                local player = Players.LocalPlayer
                local char = player.Character or player.CharacterAdded:Wait()
                local hrp = char:WaitForChild("HumanoidRootPart")

                local function moveToPosition(rootPart, targetPosition, speed)
                    -- Remove previous attachments/LinearVelocity if any
                    for _, v in ipairs(rootPart:GetChildren()) do
                        if v:IsA("LinearVelocity") or (v:IsA("Attachment") and v.Name == "MoveAttachment") then
                            v:Destroy()
                        end
                    end
                    -- Setup attachment
                    local attachment = Instance.new("Attachment")
                    attachment.Name = "MoveAttachment"
                    attachment.Parent = rootPart

                    -- Setup LinearVelocity
                    local lv = Instance.new("LinearVelocity")
                    lv.Attachment0 = attachment
                    lv.MaxForce = math.huge
                    lv.RelativeTo = Enum.ActuatorRelativeTo.World
                    lv.Parent = rootPart

                    -- Calculate direction and set velocity
                    local direction = (targetPosition - rootPart.Position).Unit
                    lv.VectorVelocity = direction * speed

                    -- Wait until near target, then stop
                    while Options.AutoWin.Value and (rootPart.Position - targetPosition).Magnitude > 2 do
                        task.wait()
                    end

                    lv:Destroy()
                    attachment:Destroy()
                end

                local target1 = Vector3.new(3, 32, -171)
                local target2 = Vector3.new(2, -2043, -5464)
                local speed = 100 -- Adjust as needed

                while Options.AutoWin.Value do
                    -- Add float effect (optional, as before)
                    if not hrp:FindFirstChild("FloatVelocity") then
                        local bv = Instance.new("BodyVelocity")
                        bv.Name = "FloatVelocity"
                        bv.Velocity = Vector3.new(0,0,0)
                        bv.MaxForce = Vector3.new(0, math.huge, 0)
                        bv.Parent = hrp
                    end

                    -- Move to first point smoothly
                    moveToPosition(hrp, target1, speed)
                    task.wait(1) -- Pause at first waypoint

                    -- Move to second point smoothly
                    moveToPosition(hrp, target2, speed)
                    task.wait(4) -- Wait at destination
                end

                -- Cleanup float when toggle is off
                local bv = hrp:FindFirstChild("FloatVelocity")
                if bv then bv:Destroy() end
                -- Cleanup LinearVelocity/Attachment
                for _, v in ipairs(hrp:GetChildren()) do
                    if v:IsA("LinearVelocity") or (v:IsA("Attachment") and v.Name == "MoveAttachment") then
                        v:Destroy()
                    end
                end
            end)
        else
            -- Cleanup all movers immediately
            local Players = game:GetService("Players")
            local player = Players.LocalPlayer
            local char = player.Character or player.CharacterAdded:Wait()
            local hrp = char:WaitForChild("HumanoidRootPart")
            local bv = hrp:FindFirstChild("FloatVelocity")
            if bv then bv:Destroy() end
            for _, v in ipairs(hrp:GetChildren()) do
                if v:IsA("LinearVelocity") or (v:IsA("Attachment") and v.Name == "MoveAttachment") then
                    v:Destroy()
                end
            end
        end
    end)


--------------------------------------------------
-- CONFIGURATION / MANAGERS
--------------------------------------------------

SaveManager:SetLibrary(Library)
InterfaceManager:SetLibrary(Library)

SaveManager:IgnoreThemeSettings()
SaveManager:SetIgnoreIndexes({})

InterfaceManager:SetFolder("FluentEventsHub")
SaveManager:SetFolder("FluentEventsHub/SpecificGame")

InterfaceManager:BuildInterfaceSection(Tabs.Settings)
SaveManager:BuildConfigSection(Tabs.Settings)

Window:SelectTab(1)
Library:Notify{Title = "Fluent", Content = "Script loaded successfully!", Duration = 8}
SaveManager:LoadAutoloadConfig()
