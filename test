local Library = loadstring(game:HttpGetAsync("https://github.com/ActualMasterOogway/Fluent-Renewed/releases/latest/download/Fluent.luau"))()
local SaveManager = loadstring(game:HttpGetAsync("https://raw.githubusercontent.com/ActualMasterOogway/Fluent-Renewed/master/Addons/SaveManager.luau"))()
local InterfaceManager = loadstring(game:HttpGetAsync("https://raw.githubusercontent.com/ActualMasterOogway/Fluent-Renewed/master/Addons/InterfaceManager.luau"))()

local Window = Library:Window{
    Title = "Noob Invador Script",
    SubTitle = "By coco",
    TabWidth = 130,
    Size =  UDim2.fromOffset(500, 430),
    Resize = false, 
    Theme = "Darker",
    MinimizeKey = Enum.KeyCode.LeftShift
}

-- Tabs
local Tabs = {
    mainTab = Window:CreateTab{Title = "Main Game", Icon = "phosphor-sword-bold"},
    Settings = Window:CreateTab{Title = "Settings", Icon = "phosphor-sword-bold"}
}

local Options = Library.Options

--------------------------------------------------
-- ABYSS EVENT TAB
--------------------------------------------------

local P,RS,W=game:GetService("Players"),game:GetService("ReplicatedStorage"),workspace
local LP=P.LocalPlayer
local WH=RS:WaitForChild("WeaponsSystem"):WaitForChild("Network"):WaitForChild("WeaponHit")

-- Attack Players Toggle
Tabs.mainTab:CreateToggle("AutoAttackPlayers",{Title="Auto Attack Players",Default=false}):OnChanged(function(state)
	if not state then return end
	task.spawn(function()
		while Options.AutoAttackPlayers.Value do
			local char=LP.Character
			if char then
				local wep=char:FindFirstChild("M4A1")
				local hrp=char:FindFirstChild("HumanoidRootPart")
				if wep and hrp then
					for _,plr in pairs(P:GetPlayers()) do
						if plr~=LP and plr.Character then
							local hum=plr.Character:FindFirstChild("Humanoid")
							local head=plr.Character:FindFirstChild("Head")
							if hum and head then
								WH:FireServer(wep,{p=head.Position,pid=1,part=head,d=(head.Position-hrp.Position).Magnitude,maxDist=1000,h=hum,m=Enum.Material.Plastic,n=Vector3.new(0,-1,0),t=tick(),sid=3})
							end
						end
					end
				end
			end
			task.wait(0.1)
		end
	end)
end)

Tabs.mainTab:CreateToggle("AutoAttackNPCs",{Title="Auto Attack NPCs",Default=false}):OnChanged(function(state)
	if not state then return end
	task.spawn(function()
		while Options.AutoAttackNPCs.Value do
			local char=LP.Character
			if char then
				local wep=char:FindFirstChild("M4A1")
				local hrp=char:FindFirstChild("HumanoidRootPart")
				if wep and hrp then
					local folder=W:FindFirstChild("Character")
					if folder then
						for _,npc in pairs(folder:GetChildren()) do
							if npc:IsA("Model") and npc~=char then
								local hum=npc:FindFirstChild("Humanoid")
								local head=npc:FindFirstChild("Head")
								if hum and head then
									WH:FireServer(wep,{
										p=head.Position,
										pid=1,
										part=head,
										d=1000, -- forced distance for NPCs
										maxDist=100,
										h=hum,
										m=Enum.Material.Plastic,
										n=Vector3.new(0,-1,0),
										t=tick(),
										sid=3
									})
								end
							end
						end
					end
				end
			end
			task.wait(0.1)
		end
	end)
end)

local P,RS,W=game:GetService("Players"),game:GetService("ReplicatedStorage"),workspace
local LP=P.LocalPlayer
local ThrowEvent=RS:WaitForChild("ThrowGrenadeEvent")

Tabs.mainTab:CreateToggle("InfDMG",{Title="Inf DMG",Default=false}):OnChanged(function(state)
	if not state then return end
	task.spawn(function()
		while Options.InfDMG.Value do
			local char=LP.Character
			if char then
				local hrp=char:FindFirstChild("HumanoidRootPart")
				if hrp then
					-- Players
					for _,plr in pairs(P:GetPlayers()) do
						if plr~=LP and plr.Character then
							local targetPos=plr.Character:FindFirstChild("HumanoidRootPart") or plr.Character:FindFirstChild("Head")
							if targetPos then
								local args={targetPos.Position, targetPos.Position}
								pcall(function()
									ThrowEvent:FireServer(unpack(args))
								end)
							end
						end
					end
					-- NPCs in workspace.Character
					local charFolder=W:FindFirstChild("Character")
					if charFolder then
						for _,npc in pairs(charFolder:GetChildren()) do
							if npc:IsA("Model") and npc~=char then
								local targetPos=npc:FindFirstChild("HumanoidRootPart") or npc:FindFirstChild("Head")
								if targetPos then
									local args={targetPos.Position, targetPos.Position}
									pcall(function()
										ThrowEvent:FireServer(unpack(args))
									end)
								end
							end
						end
					end
				end
			end
			task.wait(3) -- execute every 0.01s
		end
	end)
end)


local mainNote = Tabs.mainTab:Paragraph("Note", {
    Title = "Note",
    Content = "AutoAttack only works with M4A1",
    TitleAlignment = "Left",
    ContentAlignment = Enum.TextXAlignment.Left
})

Tabs.mainTab:CreateButton({
    Title = "Anti AFK",
    Description = "Helps you to not get kicked.",
    Callback = function()
        game:GetService('Players').LocalPlayer.Idled:Connect(function()
            game:GetService('VirtualUser'):CaptureController()
            game:GetService('VirtualUser'):ClickButton2(Vector2.new())
        end)

        game:GetService("StarterGui"):SetCore("SendNotification", {
            Title = "Anti-AFK",
            Text = "Anti-AFK is now enabled!",
            Duration = 3
        })
    end
})

Tabs.mainTab:CreateButton({
    Title = "Anti Lag",
    Description = "Decrease quality to not lag.",
    Callback = function()
        local Lighting = game:GetService("Lighting")
        local RunService = game:GetService("RunService")
        local Terrain = workspace:FindFirstChildWhichIsA("Terrain")

        -- Terrain settings
        if Terrain then
            Terrain.WaterWaveSize = 0
            Terrain.WaterWaveSpeed = 0
            Terrain.WaterReflectance = 0
            Terrain.WaterTransparency = 1
        end

        -- Lighting settings
        Lighting.GlobalShadows = false
        Lighting.FogStart = 9e9
        Lighting.FogEnd = 9e9
        settings().Rendering.QualityLevel = 1

        -- Optimize workspace parts
        for _, v in pairs(game:GetDescendants()) do
            if v:IsA("BasePart") then
                v.CastShadow = false
                v.Material = "Plastic"
                v.Reflectance = 0
                v.BackSurface = Enum.SurfaceType.SmoothNoOutlines
                v.BottomSurface = Enum.SurfaceType.SmoothNoOutlines
                v.FrontSurface = Enum.SurfaceType.SmoothNoOutlines
                v.LeftSurface = Enum.SurfaceType.SmoothNoOutlines
                v.RightSurface = Enum.SurfaceType.SmoothNoOutlines
                v.TopSurface = Enum.SurfaceType.SmoothNoOutlines
            elseif v:IsA("Decal") then
                v.Transparency = 1
                v.Texture = ""
            elseif v:IsA("ParticleEmitter") or v:IsA("Trail") then
                v.Lifetime = NumberRange.new(0)
            end
        end

        -- Disable post effects in Lighting
        for _, v in pairs(Lighting:GetDescendants()) do
            if v:IsA("PostEffect") then
                v.Enabled = false
            end
        end

        -- Remove new unwanted objects dynamically
        workspace.DescendantAdded:Connect(function(child)
            task.spawn(function()
                if child:IsA("ForceField") or child:IsA("Sparkles") or child:IsA("Smoke") or child:IsA("Fire") or child:IsA("Beam") then
                    RunService.Heartbeat:Wait()
                    child:Destroy()
                elseif child:IsA("BasePart") then
                    child.CastShadow = false
                end
            end)
        end)
    end
})

--------------------------------------------------
-- CONFIGURATION / MANAGERS
--------------------------------------------------

SaveManager:SetLibrary(Library)
InterfaceManager:SetLibrary(Library)

SaveManager:IgnoreThemeSettings()
SaveManager:SetIgnoreIndexes({})

InterfaceManager:SetFolder("FluentEventsHub")
SaveManager:SetFolder("FluentEventsHub/SpecificGame")

InterfaceManager:BuildInterfaceSection(Tabs.Settings)
SaveManager:BuildConfigSection(Tabs.Settings)

Window:SelectTab(1)
Library:Notify{Title = "Fluent", Content = "Script loaded successfully!", Duration = 8}
SaveManager:LoadAutoloadConfig()
